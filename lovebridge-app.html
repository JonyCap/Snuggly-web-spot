<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveBridge - Connect Hearts Across Distance</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #fff;
            transition: all 0.3s ease;
        }

        body.night-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s infinite alternate;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.2); }
        }

        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .heart {
            position: absolute;
            color: rgba(255, 105, 180, 0.6);
            animation: float 6s infinite linear;
            font-size: 20px;
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .auth-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.1rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            font-size: 16px;
            backdrop-filter: blur(5px);
        }

        .form-group input::placeholder, .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            margin-left: 10px;
        }

        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: block;
        }

        .header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
        }

        .welcome-msg {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .night-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .night-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h3 {
            margin-bottom: 15px;
            color: #feca57;
            font-size: 1.3rem;
        }

        .countdown {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            color: #ff6b6b;
        }

        .countdown-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }

        .diary-messages {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .message {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }

        .message-author {
            font-weight: bold;
            margin-bottom: 5px;
            color: #48dbfb;
        }

        .message-time {
            font-size: 0.8rem;
            opacity: 0.7;
            float: right;
        }

        .mood-selector {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
        }

        .mood-emoji {
            font-size: 2rem;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .mood-emoji:hover, .mood-emoji.selected {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.2);
        }

        .goals-list {
            margin-top: 15px;
        }

        .goal-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .goal-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .photo-item {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            overflow: hidden;
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .love-letter {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #ff6b6b;
            font-style: italic;
            line-height: 1.6;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close-modal {
            float: right;
            font-size: 24px;
            cursor: pointer;
            color: #ff6b6b;
        }

        .error-msg {
            color: #ff6b6b;
            text-align: center;
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 107, 107, 0.2);
            border-radius: 8px;
        }

        .success-msg {
            color: #48dbfb;
            text-align: center;
            margin-top: 10px;
            padding: 10px;
            background: rgba(72, 219, 251, 0.2);
            border-radius: 8px;
        }

        .hidden {
            display: none !important;
        }

        .loading {
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #fff;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .auth-card {
                padding: 30px 20px;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .controls {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="stars" id="stars"></div>
    <div class="floating-hearts" id="hearts"></div>

    <!-- Authentication Page -->
    <div class="auth-container" id="authContainer">
        <div class="auth-card">
            <div class="logo">üíï LoveBridge</div>
            <p class="subtitle">Connecting hearts across any distance</p>
            
            <div id="loginForm">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password">
                </div>
                <button class="btn btn-primary" onclick="login()">Sign In</button>
                <button class="btn btn-secondary" onclick="showRegister()">Create Account</button>
            </div>

            <div id="registerForm" class="hidden">
                <div class="form-group">
                    <label>Your Name</label>
                    <input type="text" id="registerName" placeholder="Your beautiful name">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="registerEmail" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="registerPassword" placeholder="Create a strong password">
                </div>
                <div class="form-group">
                    <label>Partner's Email</label>
                    <input type="email" id="partnerEmail" placeholder="Your partner's email">
                </div>
                <div class="form-group">
                    <label>Next Meeting Date</label>
                    <input type="datetime-local" id="meetingDate">
                </div>
                <button class="btn btn-primary" onclick="register()">Create Our Love Space</button>
                <button class="btn btn-secondary" onclick="showLogin()">Back to Sign In</button>
            </div>

            <div id="authError" class="error-msg hidden"></div>
            <div id="authSuccess" class="success-msg hidden"></div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div class="dashboard" id="dashboard">
        <div class="container">
            <div class="header">
                <div class="welcome-msg" id="welcomeMsg">Welcome back, lovebirds! üíï</div>
                <div class="controls">
                    <button class="night-toggle" onclick="toggleNightMode()">üåô Night Mode</button>
                    <button class="btn btn-secondary" onclick="logout()">Sign Out</button>
                </div>
            </div>

            <div class="dashboard-grid">
                <!-- Countdown Timer -->
                <div class="card">
                    <h3>‚è∞ Until We Meet</h3>
                    <div class="countdown" id="countdown">
                        <div>00</div>
                        <div class="countdown-label">Days</div>
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn btn-primary" onclick="openModal('meetingModal')">Update Meeting Date</button>
                    </div>
                </div>

                <!-- Love Diary -->
                <div class="card">
                    <h3>üíå Our Love Diary</h3>
                    <div class="diary-messages" id="diaryMessages"></div>
                    <div class="form-group">
                        <input type="text" id="newMessage" placeholder="Share something beautiful..." onkeypress="if(event.key==='Enter') sendMessage()">
                    </div>
                    <button class="btn btn-primary" onclick="sendMessage()">Send Love</button>
                </div>

                <!-- Mood Tracker -->
                <div class="card">
                    <h3>üíù Daily Mood</h3>
                    <p>How are you feeling today?</p>
                    <div class="mood-selector">
                        <span class="mood-emoji" onclick="setMood('üòç', 5)" title="Amazing">üòç</span>
                        <span class="mood-emoji" onclick="setMood('üòä', 4)" title="Happy">üòä</span>
                        <span class="mood-emoji" onclick="setMood('üòê', 3)" title="Okay">üòê</span>
                        <span class="mood-emoji" onclick="setMood('üòî', 2)" title="Sad">üòî</span>
                        <span class="mood-emoji" onclick="setMood('üò¢', 1)" title="Missing You">üò¢</span>
                    </div>
                    <div id="moodHistory"></div>
                </div>

                <!-- AI Love Letters -->
                <div class="card">
                    <h3>ü§ñ AI Love Letter</h3>
                    <div class="form-group">
                        <input type="text" id="letterPrompt" placeholder="Give me a theme (e.g., 'missing you', 'good morning')">
                    </div>
                    <button class="btn btn-primary" onclick="generateLoveLetter()">Generate Letter</button>
                    <div id="generatedLetter"></div>
                </div>

                <!-- Shared Goals -->
                <div class="card">
                    <h3>üéØ Our Dreams Together</h3>
                    <div class="form-group">
                        <input type="text" id="newGoal" placeholder="Add a new dream or goal..." onkeypress="if(event.key==='Enter') addGoal()">
                    </div>
                    <button class="btn btn-primary" onclick="addGoal()">Add Dream</button>
                    <div class="goals-list" id="goalsList"></div>
                </div>

                <!-- Photo Album -->
                <div class="card">
                    <h3>üì∏ Our Memories</h3>
                    <input type="file" id="photoUpload" accept="image/*" style="display: none;" onchange="uploadPhoto()">
                    <button class="btn btn-primary" onclick="document.getElementById('photoUpload').click()">Add Photo</button>
                    <div class="photos-grid" id="photosGrid"></div>
                </div>

                <!-- Song of the Day -->
                <div class="card">
                    <h3>üéµ Song of the Day</h3>
                    <div class="form-group">
                        <input type="text" id="songTitle" placeholder="Song title">
                    </div>
                    <div class="form-group">
                        <input type="url" id="songUrl" placeholder="Spotify/YouTube link">
                    </div>
                    <button class="btn btn-primary" onclick="setSongOfDay()">Set Our Song</button>
                    <div id="currentSong"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Meeting Date Modal -->
    <div class="modal" id="meetingModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('meetingModal')">&times;</span>
            <h3>Update Meeting Date</h3>
            <div class="form-group">
                <label>Next Meeting Date & Time</label>
                <input type="datetime-local" id="newMeetingDate">
            </div>
            <button class="btn btn-primary" onclick="updateMeetingDate()">Update</button>
        </div>
    </div>

    <script>
        // Firebase Configuration - REPLACE WITH YOUR CONFIG
        const firebaseConfig = {
            apiKey: "your-api-key-here",
            authDomain: "your-project.firebaseapp.com",
            projectId: "your-project-id",
            storageBucket: "your-project.appspot.com",
            messagingSenderId: "123456789",
            appId: "your-app-id"
        };

        // For demo purposes, we'll simulate Firebase functionality
        // In production, you would import and initialize Firebase here

        let currentUser = null;
        let coupleData = null;
        let nightMode = false;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            createStars();
            createFloatingHearts();
            
            // Check if user is logged in (simulate)
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            }
        });

        // Authentication Functions
        function showRegister() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.remove('hidden');
        }

        function showLogin() {
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
        }

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showError('Please fill in all fields');
                return;
            }

            // Simulate login
            currentUser = {
                uid: 'demo-user-' + Date.now(),
                email: email,
                name: email.split('@')[0]
            };
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            showSuccess('Welcome back! Loading your love space...');
            
            setTimeout(() => {
                showDashboard();
            }, 1000);
        }

        function register() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const partnerEmail = document.getElementById('partnerEmail').value;
            const meetingDate = document.getElementById('meetingDate').value;
            
            if (!name || !email || !password || !partnerEmail || !meetingDate) {
                showError('Please fill in all fields');
                return;
            }

            // Simulate registration
            currentUser = {
                uid: 'demo-user-' + Date.now(),
                email: email,
                name: name,
                partnerEmail: partnerEmail,
                meetingDate: meetingDate
            };
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            showSuccess('Account created! Welcome to LoveBridge!');
            
            setTimeout(() => {
                showDashboard();
            }, 1000);
        }

        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            document.getElementById('dashboard').classList.remove('active');
            document.getElementById('authContainer').style.display = 'flex';
        }

        function showDashboard() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('dashboard').classList.add('active');
            
            // Load user data
            loadCoupleData();
            updateCountdown();
            loadDiary();
            loadMoodHistory();
            loadGoals();
            loadPhotos();
            loadCurrentSong();
            
            // Start real-time updates
            setInterval(updateCountdown, 1000);
        }

        // Dashboard Functions
        function loadCoupleData() {
            // Simulate loading couple data
            coupleData = JSON.parse(localStorage.getItem('coupleData')) || {
                meetingDate: currentUser.meetingDate || new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(),
                messages: [],
                moods: [],
                goals: [],
                photos: [],
                currentSong: null
            };
            
            document.getElementById('welcomeMsg').textContent = `Welcome back, ${currentUser.name}! üíï`;
        }

        function updateCountdown() {
            if (!coupleData.meetingDate) return;
            
            const now = new Date().getTime();
            const meetingTime = new Date(coupleData.meetingDate).getTime();
            const distance = meetingTime - now;
            
            if (distance < 0) {
                document.getElementById('countdown').innerHTML = '<div>Together! üéâ</div>';
                return;
            }
            
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            document.getElementById('countdown').innerHTML = `
                <div style="display: flex; justify-content: space-around; text-align: center;">
                    <div><div>${days}</div><div class="countdown-label">Days</div></div>
                    <div><div>${hours}</div><div class="countdown-label">Hours</div></div>
                    <div><div>${minutes}</div><div class="countdown-label">Minutes</div></div>
                    <div><div>${seconds}</div><div class="countdown-label">Seconds</div></div>
                </div>
            `;
        }

        function sendMessage() {
            const messageInput = document.getElementById('newMessage');
            const message = messageInput.value.trim();
            
            if (!message) return;
            
            const newMessage = {
                id: Date.now(),
                text: message,
                author: currentUser.name,
                timestamp: new Date().toISOString()
            };
            
            coupleData.messages.push(newMessage);
            localStorage.setItem('coupleData', JSON.stringify(coupleData));
            
            messageInput.value = '';
            loadDiary();
        }

        function loadDiary() {
            const messagesContainer = document.getElementById('diaryMessages');
            messagesContainer.innerHTML = '';
            
            coupleData.messages.slice(-10).forEach(message => {
                const messageEl = document.createElement('div');
                messageEl.className = 'message';
                messageEl.innerHTML = `
                    <div class="message-author">${message.author}
                        <span class="message-time">${new Date(message.timestamp).toLocaleTimeString()}</span>
                    </div>
                    <div>${message.text}</div>
                `;
                messagesContainer.appendChild(messageEl);
            });
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function setMood(emoji, value) {
            const today = new Date().toDateString();
            const moodIndex = coupleData.moods.findIndex(m => new Date(m.date).toDateString() === today);
            
            const mood = {
                date: new Date().toISOString(),
                emoji: emoji,
                value: value,
                user: currentUser.name
            };
            
            if (moodIndex >= 0) {
                coupleData.moods[moodIndex] = mood;
            } else {
                coupleData.moods.push(mood);
            }
            
            localStorage.setItem('coupleData', JSON.stringify(coupleData));
            
            // Visual feedback
            document.querySelectorAll('.mood-emoji').forEach(el => el.classList.remove('selected'));
            event.target.classList.add('selected');
            
            loadMoodHistory();
        }

        function loadMoodHistory() {
            const historyContainer = document.getElementById('moodHistory');
            const recentMoods = coupleData.moods.slice(-7);
            
            if (recentMoods.length === 0) {
                historyContainer.innerHTML = '<p style="text-align: center; opacity: 0.7;">No mood entries yet</p>';
                return;
            }
            
            historyContainer.innerHTML = `
                <div style="margin-top: 15px;">
                    <strong>Recent Moods:</strong>
                    <div style="display: flex; gap: 5px; margin-top: 10px; flex-wrap: wrap;">
                        ${recentMoods.map(mood => 
                            `<span title="${new Date(mood.date).toLocaleDateString()} - ${mood.user}">${mood.emoji}</span>`
                        ).join('')}
                    </div>
                </div>
            `;
        }

        function generateLoveLetter() {
            const prompt = document.getElementById('letterPrompt').value.trim();
            if (!prompt) {
                showError('Please enter a theme for your love letter');
                return;
            }
            
            const letterContainer = document.getElementById('generatedLetter');
            letterContainer.innerHTML = '<div class="loading"><div class="spinner"></div><p>Crafting your love letter...</p></div>';
            
            // Simulate AI generation with romantic templates
            setTimeout(() => {
                const templates = {
                    'missing you': `My dearest love,\n\nEvery moment apart feels like an eternity. The space between us only makes my heart grow fonder. I carry you with me in every breath, every heartbeat, every dream. Until we're together again, know that you are my everything.\n\nWith all my love,\nYour devoted partner üíï`,
                    'good morning': `Good morning, sunshine! ‚òÄÔ∏è\n\nAs the dawn breaks, my first thought is of you. Your smile brightens my day even from miles away. I hope your morning is as beautiful as you are, and that every moment brings you joy until we can share our mornings together again.\n\nSending you all my love,\nYour morning star üåü`,
                    'good night': `Sweet dreams, my love üåô\n\nAs the stars light up the night sky, I'm reminded of how you light up my world. May your dreams be filled with all the happiness you bring to my life. Sleep peacefully knowing you are deeply loved and cherished.\n\nGoodnight, beautiful,\nYour devoted heart üí§`,
                    'anniversary': `To my incredible partner,\n\nToday marks another milestone in our beautiful journey together. Through every challenge and celebration, our love has only grown stronger. You are my greatest adventure, my safe harbor, and my forever home.\n\nHere's to many more years of love,\nYours always üíñ`,
                    'default': `My beloved,\n\nWords cannot express how much you mean to me. You are the melody in my heart, the light in my darkness, and the reason I smile every day. Distance means nothing when someone means everything.\n\nForever yours,\nWith endless love üíï`
                };
                
                let letter = templates[prompt.toLowerCase()] || templates['default'];
                
                // Personalize with user's name
                letter = letter.replace('My beloved', `My dearest ${currentUser.partnerEmail ? currentUser.partnerEmail.split('@')[0] : 'love'}`);
                
                letterContainer.innerHTML = `<div class="love-letter">${letter.replace(/\n/g, '<br>')}</div>`;
            }, 2000);
        }

        function addGoal() {
            const goalInput = document.getElementById('newGoal');
            const goalText = goalInput.value.trim();
            
            if (!goalText) return;
            
            const newGoal = {
                id: Date.now(),
                text: goalText,
                completed: false,
                addedBy: currentUser.name,
                addedAt: new Date().toISOString()
            };
            
            coupleData.goals.push(newGoal);
            localStorage.setItem('coupleData', JSON.stringify(coupleData));
            
            goalInput.value = '';
            loadGoals();
        }

        function loadGoals() {
            const goalsContainer = document.getElementById('goalsList');
            goalsContainer.innerHTML = '';
            
            if (coupleData.goals.length === 0) {
                goalsContainer.innerHTML = '<p style="text-align: center; opacity: 0.7;">No dreams yet. Add your first one!</p>';
                return;
            }
            
            coupleData.goals.forEach(goal => {
                const goalEl = document.createElement('div');
                goalEl.className = `goal-item ${goal.completed ? 'completed' : ''}`;
                goalEl.innerHTML = `
                    <span>${goal.text}</span>
                    <div>
                        <button onclick="toggleGoal(${goal.id})" style="background: none; border: none; color: #48dbfb; cursor: pointer; margin-right: 10px;">
                            ${goal.completed ? '‚Ü©Ô∏è' : '‚úÖ'}
                        </button>
                        <button onclick="deleteGoal(${goal.id})" style="background: none; border: none; color: #ff6b6b; cursor: pointer;">
                            üóëÔ∏è
                        </button>
                    </div>
                `;
                goalsContainer.appendChild(goalEl);
            });
        }

        function toggleGoal(goalId) {
            const goal = coupleData.goals.find(g => g.id === goalId);
            if (goal) {
                goal.completed = !goal.completed;
                localStorage.setItem('coupleData', JSON.stringify(coupleData));
                loadGoals();
            }
        }

        function deleteGoal(goalId) {
            coupleData.goals = coupleData.goals.filter(g => g.id !== goalId);
            localStorage.setItem('coupleData', JSON.stringify(coupleData));
            loadGoals();
        }

        function uploadPhoto() {
            const fileInput = document.getElementById('photoUpload');
            const file = fileInput.files[0];
            
            if (!file) return;
            
            // In a real app, you'd upload to Firebase Storage
            // For demo, we'll use FileReader to create a preview
            const reader = new FileReader();
            reader.onload = function(e) {
                const photo = {
                    id: Date.now(),
                    url: e.target.result,
                    name: file.name,
                    uploadedBy: currentUser.name,
                    uploadedAt: new Date().toISOString()
                };
                
                coupleData.photos.push(photo);
                localStorage.setItem('coupleData', JSON.stringify(coupleData));
                loadPhotos();
            };
            reader.readAsDataURL(file);
        }

        function loadPhotos() {
            const photosContainer = document.getElementById('photosGrid');
            photosContainer.innerHTML = '';
            
            // Add upload button
            const uploadBtn = document.createElement('div');
            uploadBtn.className = 'photo-item';
            uploadBtn.style.cursor = 'pointer';
            uploadBtn.innerHTML = '<span style="font-size: 2rem;">üì∑</span>';
            uploadBtn.onclick = () => document.getElementById('photoUpload').click();
            photosContainer.appendChild(uploadBtn);
            
            // Add photos
            coupleData.photos.forEach(photo => {
                const photoEl = document.createElement('div');
                photoEl.className = 'photo-item';
                photoEl.innerHTML = `<img src="${photo.url}" alt="${photo.name}" title="Uploaded by ${photo.uploadedBy}">`;
                photosContainer.appendChild(photoEl);
            });
        }

        function setSongOfDay() {
            const title = document.getElementById('songTitle').value.trim();
            const url = document.getElementById('songUrl').value.trim();
            
            if (!title || !url) {
                showError('Please enter both title and URL');
                return;
            }
            
            coupleData.currentSong = {
                title: title,
                url: url,
                setBy: currentUser.name,
                setAt: new Date().toISOString()
            };
            
            localStorage.setItem('coupleData', JSON.stringify(coupleData));
            
            document.getElementById('songTitle').value = '';
            document.getElementById('songUrl').value = '';
            
            loadCurrentSong();
        }

        function loadCurrentSong() {
            const songContainer = document.getElementById('currentSong');
            
            if (!coupleData.currentSong) {
                songContainer.innerHTML = '<p style="text-align: center; opacity: 0.7;">No song set yet</p>';
                return;
            }
            
            const song = coupleData.currentSong;
            songContainer.innerHTML = `
                <div style="margin-top: 15px; padding: 15px; background: rgba(255, 255, 255, 0.1); border-radius: 10px;">
                    <div style="font-weight: bold; margin-bottom: 10px;">üéµ ${song.title}</div>
                    <div style="margin-bottom: 10px;">
                        <a href="${song.url}" target="_blank" style="color: #48dbfb; text-decoration: none;">
                            üîó Listen Now
                        </a>
                    </div>
                    <div style="font-size: 0.8rem; opacity: 0.7;">
                        Set by ${song.setBy} on ${new Date(song.setAt).toLocaleDateString()}
                    </div>
                </div>
            `;
        }

        function updateMeetingDate() {
            const newDate = document.getElementById('newMeetingDate').value;
            if (!newDate) {
                showError('Please select a date and time');
                return;
            }
            
            coupleData.meetingDate = newDate;
            localStorage.setItem('coupleData', JSON.stringify(coupleData));
            
            closeModal('meetingModal');
            showSuccess('Meeting date updated! üíï');
            updateCountdown();
        }

        // Utility Functions
        function toggleNightMode() {
            nightMode = !nightMode;
            document.body.classList.toggle('night-mode', nightMode);
            
            const btn = document.querySelector('.night-toggle');
            btn.textContent = nightMode ? '‚òÄÔ∏è Day Mode' : 'üåô Night Mode';
            
            localStorage.setItem('nightMode', nightMode);
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function showError(message) {
            const errorEl = document.getElementById('authError');
            errorEl.textContent = message;
            errorEl.classList.remove('hidden');
            setTimeout(() => errorEl.classList.add('hidden'), 5000);
        }

        function showSuccess(message) {
            const successEl = document.getElementById('authSuccess');
            successEl.textContent = message;
            successEl.classList.remove('hidden');
            setTimeout(() => successEl.classList.add('hidden'), 3000);
        }

        // Animation Functions
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }

        function createFloatingHearts() {
            const heartsContainer = document.getElementById('hearts');
            
            setInterval(() => {
                if (Math.random() < 0.3) { // 30% chance every interval
                    const heart = document.createElement('div');
                    heart.className = 'heart';
                    heart.innerHTML = 'üíï';
                    heart.style.left = Math.random() * 100 + '%';
                    heart.style.animationDuration = (Math.random() * 3 + 3) + 's';
                    heartsContainer.appendChild(heart);
                    
                    // Remove heart after animation
                    setTimeout(() => {
                        if (heart.parentNode) {
                            heart.parentNode.removeChild(heart);
                        }
                    }, 6000);
                }
            }, 2000);
        }

        // Load saved preferences
        if (localStorage.getItem('nightMode') === 'true') {
            toggleNightMode();
        }
    </script>
</body>
</html>